import{s as j,u as oe,c as ne,d as le,E as re,e as pe,v as ce,f as me,b as ie}from"./index.feaeb45b.js";import{d as ue,j as $,r as v,y as de,aI as o,a7 as u,a8 as d,Q as C,u as r,a5 as h,a6 as E,af as S,ba as b,q as Y,N as _e,bx as ye,bc as fe,X as I,aO as B}from"./@vue.54607f99.js";import{d as ve}from"./pinia.ad627e1a.js";import{u as he}from"./useOperate.5b1521cf.js";import{b as ge,u as Pe}from"./vue-router.438671b5.js";const R=()=>j({url:"/command-factory/type-list",method:"GET"}),Ce=a=>j({url:"/command-factory/list",method:"GET",params:a}),be=ve("prompts",{state:()=>({commandPrompts:JSON.parse(localStorage.getItem("commandPrompts")||"[]"),typeId:12,typeName:"",isToChat:!1,promptsToChat:{name:"",value:""}}),getters:{filterCommandPrompts(a){return l=>a.commandPrompts.filter(g=>g.describe_context.toLowerCase().indexOf(l.toLowerCase())!==-1)},filterContent(a){const l=[];for(const g of a.commandPrompts)l.push(g.describe_context);return l}},actions:{addPrompts(a,l){l!==-1&&this.commandPrompts.splice(l,1),this.commandPrompts.unshift(a),this.setPrompts()},setPrompts(){localStorage.setItem("commandPrompts",JSON.stringify(this.commandPrompts))},updateType(a,l){this.typeId=a,this.typeName=l},getCommandPrompts(){return JSON.parse(localStorage.getItem("commandPrompts")||"[]")},setToChat(a){this.isToChat=a},setPromptsToChat(a){this.promptsToChat=a}}}),ke={class:"category"},Te={key:1,class:"search-results"},Ne={class:"results"},Ee={key:0,class:"promptsBox"},Se={class:"prompts-title"},Ie={key:0},xe={class:"prompts-text"},we=["innerHTML"],Ve={class:"prompts-button"},Be=ue({__name:"Prompts",props:{isPopup:{type:Boolean,default:!0},className:{type:String,default:""}},emits:["close","setInputObject"],setup(a,{emit:l}){const g=a,s=be(),L=oe(),p=()=>({TYPE:0,NAME:i18n.t("prompts.common")});$(()=>L.langs,p);const{handleCopyText:D}=he(),F=ge(),J=Pe(),_=v(!1),c=v(""),m=v(s.typeId),f=v(!1),x=de(()=>J.name==="Prompts"),y=v([{id:p().TYPE,type_name:p().NAME}]),k=v({id:p().TYPE,type_name:p().NAME,data:[]}),K=(e,t)=>{s.addPrompts({type_id:p().TYPE,type_name:p().NAME,describe_context:t},s.filterContent.indexOf(t)),s.setPromptsToChat({name:e,value:t}),x.value?(s.setToChat(!0),F.push({name:"Chat"})):(l("setInputObject"),l("close"))},w=()=>{c.value=""},G=async e=>{e=e.replace(/%style_tag_pre%/g,"").replace(/%style_tag_next%/g,""),D(e)},H=e=>{var t,n;M({type_id:Number((t=e.props)==null?void 0:t.name),type_name:(n=e.props)==null?void 0:n.label})},Q=()=>{var e;M({type_id:m.value,type_name:(e=y.value[m.value])==null?void 0:e.type_name})},M=async e=>{f.value&&(w(),f.value=!1),_.value=!0,s.commandPrompts=s.getCommandPrompts(),await T(e),_.value=!1},U=async()=>{if(!!c.value.trim()){if(_.value=!0,f.value=!0,m.value===12){const t={type_id:y.value[0].id,context:c.value};await T(t)}else{const e=y.value[m.value],t={type_id:e.id,type_name:e.type_name,context:c.value};await T(t)}_.value=!1,w()}},T=async e=>{const t=e.type_name;delete e.type_name;const n=await Ce(e);if(k.value={id:e.type_id,type_name:t,data:[]},e.type_id===s.typeId){let P=[...s.commandPrompts];f.value&&(P=s.filterCommandPrompts(c.value.trim())),k.value.data=[{id:p().TYPE,type_name:p().NAME,data:P},{id:s.typeId,type_name:s.typeName,data:[...n]}]}else k.value.data.unshift({id:e.type_id,type_name:t,data:[...n]})},O=async e=>{y.value=[{id:e.alone_list[0].id,type_name:p().NAME}],X(e.alone_list[0].id,e.alone_list[0].type_name),y.value.push(...e.menu_list)},A=async(e,t)=>{_.value=!0;const n=await R();O(n),await T({type_id:e,type_name:t}),_.value=!1};A(s.typeId,s.typeName),$(()=>L.langs,async()=>{var t;const e=await R();O(e),A(m.value,(t=y.value[m.value])==null?void 0:t.type_name)});const z=e=>e.replace(/%style_tag_pre%/g,'<span style="color: #685BFF;">').replace(/%style_tag_next%/g,"</span>"),X=(e,t)=>{s.updateType(e,t)};return(e,t)=>{const n=me,P=ne,W=le,Z=re,q=pe,ee=ce;return o(),u("div",{class:_e(["prompts",g.className])},[d("p",ke,C(e.$t("prompts.category")),1),r(x)?E("",!0):(o(),h(n,{key:0,"class-name":"close-prompts",icon:"common-close",onClick:t[0]||(t[0]=i=>l("close"))})),S(q,{modelValue:r(m),"onUpdate:modelValue":t[2]||(t[2]=i=>Y(m)?m.value=i:null),"tab-position":"left",type:"card",class:"prompts-tabs",onTabClick:H},{default:b(()=>[r(f)?(o(),u("div",Te,[d("p",{class:"back",onClick:Q},[S(n,{icon:"create-back",class:"icon-back"}),d("span",null,C(e.$t("prompts.back")),1)]),d("p",Ne,C(e.$t("prompts.searchResults")),1)])):(o(),h(P,{key:0,modelValue:r(c),"onUpdate:modelValue":t[1]||(t[1]=i=>Y(c)?c.value=i:null),placeholder:e.$t("prompts.search"),onKeyup:ye(U,["enter"])},{prefix:b(()=>[S(n,{icon:"common-search"})]),suffix:b(()=>[r(c).length>0?(o(),h(n,{key:0,"class-name":"clear-input",icon:"common-close",onClick:w})):E("",!0)]),_:1},8,["modelValue","placeholder","onKeyup"])),fe((o(),h(Z,{class:"prompts-scroll"},{default:b(()=>[(o(!0),u(I,null,B(r(y),i=>(o(),h(W,{key:i.id,name:i.id,label:i.type_name},{default:b(()=>[(o(!0),u(I,null,B(r(k).data,(N,te)=>(o(),u(I,{key:te},[Boolean(N.data.length)||r(f)?(o(),u("div",Ee,[d("p",Se,C(N.type_name),1),d("ul",null,[!Boolean(N.data.length)&&!r(_)?(o(),u("li",Ie,C(e.$t("prompts.noQuestions")),1)):(o(!0),u(I,{key:1},B(N.data,(V,ae)=>(o(),u("li",{key:ae,class:"prompts-list"},[d("div",xe,[d("p",{class:"copy-txt",innerHTML:z(V.describe_context)},null,8,we)]),d("div",Ve,[S(n,{"class-name":"send-icon","custom-style":!1,icon:"chat-send",onClick:se=>K(i.type_name,V.describe_context)},null,8,["onClick"]),r(x)?(o(),h(n,{key:0,"class-name":"copy-icon","custom-style":!1,icon:"chat-copy",onClick:se=>G(V.describe_context)},null,8,["onClick"])):E("",!0)])]))),128))])])):E("",!0)],64))),128))]),_:2},1032,["name","label"]))),128))]),_:1})),[[ee,r(_)]])]),_:1},8,["modelValue"])],2)}}});const Ye=ie(Be,[["__scopeId","data-v-e702869c"]]);export{Ye as P,be as u};
