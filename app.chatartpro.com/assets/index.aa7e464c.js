import{I as Y,J as fe,K as G,L as ve,M as me,N as Z,O as Oe,P as ee,Q as pe,R as Q,V as Ae,W as $e,X as ae,Y as K,Z as Re,$ as ze}from"./index.feaeb45b.js";import{bE as je,bz as X,r as M,y as v,d as N,j as $,aK as he,b as be,x as ge,aI as H,a7 as ye,aP as A,N as B,u,bD as _e,p as R,o as Se,a as Fe,aH as qe,af as z,X as ke,n as We,b3 as Te,ba as U,a5 as De,aS as Ke,P as se,ae as Ue,Q as ne,a6 as ie,a8 as ue,bg as Ge}from"./@vue.54607f99.js";import{c as J,h as de}from"./lodash-es.6c80442e.js";import{S as Qe}from"./async-validator.fb49d0f5.js";import{c as Xe,r as He}from"./@vueuse.dfe8520e.js";const Je=Y({size:{type:String,values:fe},disabled:Boolean}),Ye=Y({...Je,model:Object,rules:{type:G(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:Boolean,scrollToError:Boolean,scrollIntoViewOptions:{type:[Object,Boolean]}}),Ze={validate:(d,p,e)=>(je(d)||X(d))&&ve(p)&&X(e)};function et(){const d=M([]),p=v(()=>{if(!d.value.length)return"0";const i=Math.max(...d.value);return i?`${i}px`:""});function e(i){const n=d.value.indexOf(i);return n===-1&&p.value,n}function c(i,n){if(i&&n){const f=e(n);d.value.splice(f,1,i)}else i&&d.value.push(i)}function t(i){const n=e(i);n>-1&&d.value.splice(n,1)}return{autoLabelWidth:p,registerLabelWidth:c,deregisterLabelWidth:t}}const O=(d,p)=>{const e=J(p);return e.length>0?d.filter(c=>c.prop&&e.includes(c.prop)):d},tt="ElForm",lt=N({name:tt}),rt=N({...lt,props:Ye,emits:Ze,setup(d,{expose:p,emit:e}){const c=d,t=[],i=me(),n=Z("form"),f=v(()=>{const{labelPosition:o,inline:s}=c;return[n.b(),n.m(i.value||"default"),{[n.m(`label-${o}`)]:o,[n.m("inline")]:s}]}),E=o=>{t.push(o)},g=o=>{o.prop&&t.splice(t.indexOf(o),1)},a=(o=[])=>{!c.model||O(t,o).forEach(s=>s.resetField())},b=(o=[])=>{O(t,o).forEach(s=>s.clearValidate())},y=v(()=>!!c.model),x=o=>{if(t.length===0)return[];const s=O(t,o);return s.length?s:[]},C=async o=>w(void 0,o),W=async(o=[])=>{if(!y.value)return!1;const s=x(o);if(s.length===0)return!0;let _={};for(const S of s)try{await S.validate("")}catch(I){_={..._,...I}}return Object.keys(_).length===0?!0:Promise.reject(_)},w=async(o=[],s)=>{const _=!_e(s);try{const S=await W(o);return S===!0&&(s==null||s(S)),S}catch(S){if(S instanceof Error)throw S;const I=S;return c.scrollToError&&P(Object.keys(I)[0]),s==null||s(!1,I),_&&Promise.reject(I)}},P=o=>{var s;const _=O(t,o)[0];_&&((s=_.$el)==null||s.scrollIntoView(c.scrollIntoViewOptions))};return $(()=>c.rules,()=>{c.validateOnRuleChange&&C().catch(o=>Oe())},{deep:!0}),he(ee,be({...ge(c),emit:e,resetFields:a,clearValidate:b,validateField:w,addField:E,removeField:g,...et()})),p({validate:C,validateField:w,resetFields:a,clearValidate:b,scrollToField:P}),(o,s)=>(H(),ye("form",{class:B(u(f))},[A(o.$slots,"default")],2))}});var ot=pe(rt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/form/src/form.vue"]]);const at=["","error","validating","success"],st=Y({label:String,labelWidth:{type:[String,Number],default:""},prop:{type:G([String,Array])},required:{type:Boolean,default:void 0},rules:{type:G([Object,Array])},error:String,validateStatus:{type:String,values:at},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:fe}}),ce="ElLabelWrap";var nt=N({name:ce,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(d,{slots:p}){const e=R(ee,void 0),c=R(Q);c||Ae(ce,"usage: <el-form-item><label-wrap /></el-form-item>");const t=Z("form"),i=M(),n=M(0),f=()=>{var a;if((a=i.value)!=null&&a.firstElementChild){const b=window.getComputedStyle(i.value.firstElementChild).width;return Math.ceil(Number.parseFloat(b))}else return 0},E=(a="update")=>{We(()=>{p.default&&d.isAutoWidth&&(a==="update"?n.value=f():a==="remove"&&(e==null||e.deregisterLabelWidth(n.value)))})},g=()=>E("update");return Se(()=>{g()}),Fe(()=>{E("remove")}),qe(()=>g()),$(n,(a,b)=>{d.updateAll&&(e==null||e.registerLabelWidth(a,b))}),Xe(v(()=>{var a,b;return(b=(a=i.value)==null?void 0:a.firstElementChild)!=null?b:null}),g),()=>{var a,b;if(!p)return null;const{isAutoWidth:y}=d;if(y){const x=e==null?void 0:e.autoLabelWidth,C=c==null?void 0:c.hasLabel,W={};if(C&&x&&x!=="auto"){const w=Math.max(0,Number.parseInt(x,10)-n.value),P=e.labelPosition==="left"?"marginRight":"marginLeft";w&&(W[P]=`${w}px`)}return z("div",{ref:i,class:[t.be("item","label-wrap")],style:W},[(a=p.default)==null?void 0:a.call(p)])}else return z(ke,{ref:i},[(b=p.default)==null?void 0:b.call(p)])}}});const it=["role","aria-labelledby"],ut=N({name:"ElFormItem"}),dt=N({...ut,props:st,setup(d,{expose:p}){const e=d,c=Te(),t=R(ee,void 0),i=R(Q,void 0),n=me(void 0,{formItem:!1}),f=Z("form-item"),E=$e().value,g=M([]),a=M(""),b=He(a,100),y=M(""),x=M();let C,W=!1;const w=v(()=>{if((t==null?void 0:t.labelPosition)==="top")return{};const l=ae(e.labelWidth||(t==null?void 0:t.labelWidth)||"");return l?{width:l}:{}}),P=v(()=>{if((t==null?void 0:t.labelPosition)==="top"||(t==null?void 0:t.inline))return{};if(!e.label&&!e.labelWidth&&Ie)return{};const l=ae(e.labelWidth||(t==null?void 0:t.labelWidth)||"");return!e.label&&!c.label?{marginLeft:l}:{}}),o=v(()=>[f.b(),f.m(n.value),f.is("error",a.value==="error"),f.is("validating",a.value==="validating"),f.is("success",a.value==="success"),f.is("required",Ce.value||e.required),f.is("no-asterisk",t==null?void 0:t.hideRequiredAsterisk),(t==null?void 0:t.requireAsteriskPosition)==="right"?"asterisk-right":"asterisk-left",{[f.m("feedback")]:t==null?void 0:t.statusIcon}]),s=v(()=>ve(e.inlineMessage)?e.inlineMessage:(t==null?void 0:t.inlineMessage)||!1),_=v(()=>[f.e("error"),{[f.em("error","inline")]:s.value}]),S=v(()=>e.prop?X(e.prop)?e.prop:e.prop.join("."):""),I=v(()=>!!(e.label||c.label)),j=v(()=>e.for||g.value.length===1?g.value[0]:void 0),q=v(()=>!j.value&&I.value),Ie=!!i,te=v(()=>{const l=t==null?void 0:t.model;if(!(!l||!e.prop))return K(l,e.prop).value}),k=v(()=>{const{required:l}=e,r=[];e.rules&&r.push(...J(e.rules));const h=t==null?void 0:t.rules;if(h&&e.prop){const m=K(h,e.prop).value;m&&r.push(...J(m))}if(l!==void 0){const m=r.map((F,V)=>[F,V]).filter(([F])=>Object.keys(F).includes("required"));if(m.length>0)for(const[F,V]of m)F.required!==l&&(r[V]={...F,required:l});else r.push({required:l})}return r}),Ee=v(()=>k.value.length>0),xe=l=>k.value.filter(h=>!h.trigger||!l?!0:Array.isArray(h.trigger)?h.trigger.includes(l):h.trigger===l).map(({trigger:h,...m})=>m),Ce=v(()=>k.value.some(l=>l.required)),Me=v(()=>{var l;return b.value==="error"&&e.showMessage&&((l=t==null?void 0:t.showMessage)!=null?l:!0)}),le=v(()=>`${e.label||""}${(t==null?void 0:t.labelSuffix)||""}`),L=l=>{a.value=l},Pe=l=>{var r,h;const{errors:m,fields:F}=l;(!m||!F)&&console.error(l),L("error"),y.value=m?(h=(r=m==null?void 0:m[0])==null?void 0:r.message)!=null?h:`${e.prop} is required`:"",t==null||t.emit("validate",e.prop,!1,y.value)},Le=()=>{L("success"),t==null||t.emit("validate",e.prop,!0,"")},Ve=async l=>{const r=S.value;return new Qe({[r]:l}).validate({[r]:te.value},{firstFields:!0}).then(()=>(Le(),!0)).catch(m=>(Pe(m),Promise.reject(m)))},re=async(l,r)=>{if(W||!e.prop)return!1;const h=_e(r);if(!Ee.value)return r==null||r(!1),!1;const m=xe(l);return m.length===0?(r==null||r(!0),!0):(L("validating"),Ve(m).then(()=>(r==null||r(!0),!0)).catch(F=>{const{fields:V}=F;return r==null||r(!1,V),h?!1:Promise.reject(V)}))},T=()=>{L(""),y.value="",W=!1},oe=async()=>{const l=t==null?void 0:t.model;if(!l||!e.prop)return;const r=K(l,e.prop);W=!0,r.value=de(C),await We(),T(),W=!1},Be=l=>{g.value.includes(l)||g.value.push(l)},Ne=l=>{g.value=g.value.filter(r=>r!==l)};$(()=>e.error,l=>{y.value=l||"",L(l?"error":"")},{immediate:!0}),$(()=>e.validateStatus,l=>L(l||""));const D=be({...ge(e),$el:x,size:n,validateState:a,labelId:E,inputIds:g,isGroup:q,hasLabel:I,addInputId:Be,removeInputId:Ne,resetField:oe,clearValidate:T,validate:re});return he(Q,D),Se(()=>{e.prop&&(t==null||t.addField(D),C=de(te.value))}),Fe(()=>{t==null||t.removeField(D)}),p({size:n,validateMessage:y,validateState:a,validate:re,clearValidate:T,resetField:oe}),(l,r)=>{var h;return H(),ye("div",{ref_key:"formItemRef",ref:x,class:B(u(o)),role:u(q)?"group":void 0,"aria-labelledby":u(q)?u(E):void 0},[z(u(nt),{"is-auto-width":u(w).width==="auto","update-all":((h=u(t))==null?void 0:h.labelWidth)==="auto"},{default:U(()=>[u(I)?(H(),De(Ke(u(j)?"label":"div"),{key:0,id:u(E),for:u(j),class:B(u(f).e("label")),style:se(u(w))},{default:U(()=>[A(l.$slots,"label",{label:u(le)},()=>[Ue(ne(u(le)),1)])]),_:3},8,["id","for","class","style"])):ie("v-if",!0)]),_:3},8,["is-auto-width","update-all"]),ue("div",{class:B(u(f).e("content")),style:se(u(P))},[A(l.$slots,"default"),z(Ge,{name:`${u(f).namespace.value}-zoom-in-top`},{default:U(()=>[u(Me)?A(l.$slots,"error",{key:0,error:y.value},()=>[ue("div",{class:B(u(_))},ne(y.value),3)]):ie("v-if",!0)]),_:3},8,["name"])],6)],10,it)}}});var we=pe(dt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/form/src/form-item.vue"]]);const ht=Re(ot,{FormItem:we}),bt=ze(we);export{bt as E,ht as a};
